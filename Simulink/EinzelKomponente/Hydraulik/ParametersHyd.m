%% PARAMETERS
% INITIALISATION OF THE MODEL PARAMETER
% STATUS: TESTING

%% General
SimulTime = 1000;
T_amb     = 296;    % [K] Ambient Temperature

%% Shedule
Schedule.time =           [0, 100,900,1000];
Schedule.signals.values = [0, 4,4,0]';

%% Job
Job.time =       [ 0, 150,160,230,240,320,330,400,405,475,480,600];
Job.omega_dem  = [ 200, 50, 1500,50, 1500,50,1300,50,1200,50,1100,50]/30*pi;
Job.M_dem      = [ 25,  5, 80,  5, 80,5,80,5,45,5,35,5];
Job.M_dem(isinf(Job.M_dem)) = 0;
%% Hydraulik
% Oeldaten HPL 46
K=2*10^9;       %Kompressionsmodul [N/m^2]
ypsilon=46/1000^2;  %Kinematische Viskosiät [m^2/s]
roh=0.85*1000;      %Dichte [kg/m^3]
eta=ypsilon*roh     %Dynamische Viskosität [Ns/m^2]

%% Drives
Job.Vorschub= [3,1,1,1,5,4,1,1,1,1,1,1]
Job.Kraft=[5,100,100,50,10,10,120,120,120,120,120,5]
%time=[]
%Vorschub=3;
%Kraft=100;

hsp=200; %Spindelsteigung [mm];
r= 0.2;  %Reibung;
% Drive
Drive.Pmax = 2*4000;  % [W] Maximum mechanical shaft power
Drive.Theta = .03;    % [m^2 kg] Main drive inertia
Drive.Tabelomega= [150	300	450	600	750	900	1050	1200	1350	1500	1650	1800	1950	2100	2250	2400	2550	2700	2850	3000];
Drive.TabelM = [0.475	0.95	1.425	1.9	2.375	2.85	3.325	3.8	  4.275	 4.75 	5.225	5.7	6.175 	6.65	7.125	7.6 	8.075	8.55 9.025 9.5];
Drive.Tabeleta=([   
0.500	0.500	0.500	0.500	0.500	0.500	0.700	0.700	0.700	0.700	0.700	0.700	0.700	0.700	0.700	0.500	0.500	0.500	0.500	0.500
0.500	0.500	0.500	0.700	0.730	0.750	0.755	0.765	0.770	0.770	0.770	0.770	0.765	0.760	0.755	0.753	0.750	0.748	0.745	0.740
0.500	0.500	0.710	0.750	0.780	0.800	0.810	0.820	0.825	0.825	0.825	0.825	0.825	0.820	0.815	0.815	0.810	0.810	0.805	0.800
0.500	0.500	0.740	0.780	0.805	0.825	0.835	0.845	0.850	0.855	0.855	0.855	0.855	0.850	0.855	0.853	0.850	0.848	0.845	0.840
0.500	0.500	0.755	0.800	0.825	0.840	0.855	0.855	0.860	0.860	0.860	0.860	0.870	0.865	0.870	0.863	0.865	0.868	0.865	0.860
0.500	0.500	0.765	0.805	0.835	0.850	0.860	0.865	0.870	0.870	0.870	0.870	0.880	0.880	0.875	0.870	0.875	0.875	0.870	0.870
0.500	0.710	0.785	0.825	0.845	0.860	0.875	0.875	0.880	0.880	0.880	0.880	0.890	0.885	0.880	0.880	0.855	0.855	0.865	0.860
0.500	0.755	0.825	0.850	0.870	0.875	0.890	0.893	0.895	0.895	0.895	0.890	0.885	0.880	0.880	0.875	0.845	0.845	0.855	0.850
0.500	0.790	0.845	0.870	0.885	0.890	0.903	0.905	0.908	0.908	0.905	0.895	0.880	0.875	0.875	0.870	0.840	0.840	0.845	0.840
0.720	0.825	0.865	0.885	0.900	0.903	0.905	0.908	0.910	0.910	0.910	0.900	0.875	0.870	0.870	0.865	0.835	0.830	0.835	0.830
0.750	0.850	0.885	0.900	0.905	0.905	0.908	0.910	0.913	0.913	0.905	0.895	0.870	0.865	0.865	0.860	0.830	0.820	0.825	0.820
0.770	0.860	0.895	0.905	0.908	0.908	0.910	0.913	0.915	0.915	0.895	0.890	0.865	0.860	0.860	0.855	0.825	0.810	0.805	0.800
0.790	0.875	0.900	0.910	0.910	0.910	0.913	0.915	0.918	0.918	0.890	0.885	0.860	0.855	0.855	0.850	0.820	0.800	0.795	0.780
0.820	0.880	0.905	0.915	0.913	0.913	0.915	0.918	0.920	0.920	0.885	0.880	0.855	0.850	0.850	0.845	0.815	0.790	0.785	0.770
0.830	0.890	0.910	0.920	0.915	0.915	0.918	0.920	0.923	0.918	0.880	0.875	0.850	0.845	0.845	0.840	0.810	0.780	0.775	0.760
0.840	0.900	0.915	0.923	0.918	0.918	0.920	0.923	0.925	0.915	0.875	0.870	0.845	0.840	0.840	0.835	0.805	0.770	0.765	0.750
0.850	0.905	0.920	0.926	0.920	0.920	0.923	0.925	0.928	0.913	0.870	0.865	0.840	0.835	0.835	0.830	0.800	0.760	0.755	0.740
0.860	0.910	0.925	0.930	0.923	0.923	0.925	0.928	0.925	0.910	0.865	0.860	0.835	0.830	0.830	0.825	0.795	0.750	0.745	0.730
0.870	0.915	0.930	0.933	0.925	0.925	0.928	0.925	0.920	0.908	0.860	0.855	0.830	0.825	0.825	0.820	0.790	0.740	0.735	0.720
0.880	0.920	0.935	0.935	0.928	0.928	0.925	0.920	0.918	0.905	0.855	0.850	0.825	0.820	0.820	0.810	0.785	0.730	0.725	0.710
 ]);

%% Heatflow 
cp= 460;            % [J/kg/K] Internal heat capacity
R  = 25;            % [W/K/m^2] Heat transfere resistance of surface
e=  0.9;                % emission
sb=5.67*(10^-8);        % [W/m^2/K^4] Stefan Boltzmann constant

%%Heatflow Drives
Drive.m = 10;            % [kg] Mass
Drive.A  = 0.6;           % [m^2] surface area
%% Main Drive
MainDrive.Pmax = 41600;  % [W] Maximum mechanical shaft power
MainDrive.Theta = .01;    % [m^2 kg] Main drive inertia
MainDrive.Tabelomega= [100	200	300	400	500	600	700	800	900	1000	1100	1200	1300	1400	1500	1600	1700	1800	1900	2000	2100	2200	2300	2400	2500	2600	2700	2800	2900	3000	3100	3200	3300	3400	3500	3600	3700	3800	3900	4000	4100	4200	4300	4400	4500	4600	4700	4800	4900	5000	5100	5200	5300	5400	5500	5600	5700	5800	5900	6000	6100	6200	6300	6400	6500
];
MainDrive.TabelM = [100	200	300	400	500	600	700	800	900	1000	5000	10000	15000	20000	25000	30000	35000	40000	41600];
MainDrive.Tabeleta=([     
0.36	0.53	0.63	0.69	0.74	0.77	0.80	0.82	0.83	0.85	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00
0.38	0.38	0.47	0.55	0.60	0.64	0.68	0.71	0.73	0.75	0.94	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00
0.34	0.25	0.34	0.40	0.46	0.51	0.54	0.58	0.60	0.63	0.89	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00
0.30	0.17	0.24	0.30	0.35	0.39	0.42	0.46	0.49	0.51	0.84	0.91	0.00	0.00	0.00	0.00	0.00	0.00	0.00
0.26	0.12	0.17	0.22	0.26	0.30	0.33	0.36	0.39	0.41	0.78	0.88	0.00	0.00	0.00	0.00	0.00	0.00	0.00
0.23	0.09	0.13	0.17	0.20	0.23	0.26	0.29	0.31	0.33	0.72	0.83	0.88	0.00	0.00	0.00	0.00	0.00	0.00
0.21	0.07	0.10	0.13	0.16	0.18	0.21	0.23	0.25	0.27	0.65	0.79	0.85	0.00	0.00	0.00	0.00	0.00	0.00
0.19	0.05	0.08	0.10	0.13	0.15	0.17	0.19	0.21	0.22	0.59	0.74	0.81	0.85	0.00	0.00	0.00	0.00	0.00
0.17	0.04	0.06	0.08	0.10	0.12	0.14	0.16	0.17	0.19	0.53	0.70	0.78	0.82	0.00	0.00	0.00	0.00	0.00
0.16	0.04	0.05	0.07	0.09	0.10	0.12	0.13	0.14	0.16	0.48	0.65	0.74	0.79	0.82	0.00	0.00	0.00	0.00
0.15	0.03	0.04	0.06	0.07	0.08	0.10	0.11	0.12	0.13	0.44	0.61	0.70	0.76	0.79	0.82	0.00	0.00	0.00
0.13	0.03	0.04	0.05	0.06	0.07	0.08	0.09	0.10	0.12	0.39	0.57	0.66	0.72	0.76	0.80	0.00	0.00	0.00
0.13	0.02	0.03	0.04	0.05	0.06	0.07	0.08	0.09	0.10	0.36	0.53	0.62	0.69	0.73	0.77	0.79	0.00	0.00
0.12	0.02	0.03	0.04	0.05	0.05	0.06	0.07	0.08	0.09	0.32	0.49	0.59	0.66	0.70	0.74	0.77	0.00	0.00
0.11	0.02	0.02	0.03	0.04	0.05	0.05	0.06	0.07	0.08	0.29	0.45	0.55	0.62	0.67	0.71	0.74	0.77	0.78
0.10	0.01	0.02	0.03	0.04	0.04	0.05	0.05	0.06	0.07	0.27	0.42	0.52	0.59	0.64	0.69	0.72	0.74	0.75
0.10	0.01	0.02	0.02	0.03	0.04	0.04	0.05	0.05	0.06	0.24	0.39	0.49	0.56	0.61	0.66	0.69	0.72	0.73
0.09	0.01	0.02	0.02	0.03	0.03	0.04	0.04	0.05	0.05	0.22	0.36	0.46	0.53	0.59	0.63	0.66	0.69	0.70
0.09	0.01	0.01	0.02	0.02	0.03	0.03	0.04	0.04	0.05	0.20	0.33	0.43	0.50	0.56	0.60	0.64	0.67	0.68
0.08	0.01	0.01	0.02	0.02	0.03	0.03	0.03	0.04	0.04	0.18	0.31	0.40	0.47	0.53	0.57	0.61	0.64	0.65
0.08	0.01	0.01	0.02	0.02	0.02	0.03	0.03	0.04	0.04	0.17	0.29	0.38	0.45	0.50	0.55	0.59	0.62	0.63
0.07	0.01	0.01	0.01	0.02	0.02	0.02	0.03	0.03	0.04	0.15	0.27	0.35	0.42	0.48	0.52	0.56	0.59	0.60
0.07	0.01	0.01	0.01	0.02	0.02	0.02	0.03	0.03	0.03	0.14	0.25	0.33	0.40	0.45	0.50	0.54	0.57	0.58
0.07	0.01	0.01	0.01	0.01	0.02	0.02	0.02	0.03	0.03	0.13	0.23	0.31	0.38	0.43	0.47	0.51	0.55	0.56
0.06	0.01	0.01	0.01	0.01	0.02	0.02	0.02	0.02	0.03	0.12	0.22	0.29	0.36	0.41	0.45	0.49	0.52	0.53
0.06	0.01	0.01	0.01	0.01	0.01	0.02	0.02	0.02	0.02	0.11	0.20	0.28	0.34	0.39	0.43	0.47	0.50	0.51
0.06	0.00	0.01	0.01	0.01	0.01	0.02	0.02	0.02	0.02	0.10	0.19	0.26	0.32	0.37	0.41	0.45	0.48	0.49
0.06	0.00	0.01	0.01	0.01	0.01	0.01	0.02	0.02	0.02	0.10	0.18	0.24	0.30	0.35	0.39	0.43	0.46	0.47
0.05	0.00	0.01	0.01	0.01	0.01	0.01	0.02	0.02	0.02	0.09	0.17	0.23	0.29	0.33	0.38	0.41	0.44	0.45
0.05	0.00	0.01	0.01	0.01	0.01	0.01	0.01	0.02	0.02	0.09	0.16	0.22	0.27	0.32	0.36	0.39	0.43	0.44
0.05	0.00	0.01	0.01	0.01	0.01	0.01	0.01	0.02	0.02	0.08	0.15	0.21	0.26	0.30	0.34	0.38	0.41	0.42
0.05	0.00	0.00	0.01	0.01	0.01	0.01	0.01	0.01	0.02	0.07	0.14	0.20	0.24	0.29	0.33	0.36	0.39	0.40
0.05	0.00	0.00	0.01	0.01	0.01	0.01	0.01	0.01	0.01	0.07	0.13	0.19	0.23	0.27	0.31	0.35	0.38	0.39
0.05	0.00	0.00	0.01	0.01	0.01	0.01	0.01	0.01	0.01	0.07	0.12	0.18	0.22	0.26	0.30	0.33	0.36	0.37
0.04	0.00	0.00	0.01	0.01	0.01	0.01	0.01	0.01	0.01	0.06	0.12	0.17	0.21	0.25	0.29	0.32	0.35	0.36
0.04	0.00	0.00	0.01	0.01	0.01	0.01	0.01	0.01	0.01	0.06	0.11	0.16	0.20	0.24	0.27	0.31	0.34	0.34
0.04	0.00	0.00	0.00	0.01	0.01	0.01	0.01	0.01	0.01	0.06	0.11	0.15	0.19	0.23	0.26	0.29	0.32	0.33
0.04	0.00	0.00	0.00	0.01	0.01	0.01	0.01	0.01	0.01	0.05	0.10	0.14	0.18	0.22	0.25	0.28	0.31	0.32
0.04	0.00	0.00	0.00	0.01	0.01	0.01	0.01	0.01	0.01	0.05	0.10	0.14	0.18	0.21	0.24	0.27	0.30	0.31
0.04	0.00	0.00	0.00	0.01	0.01	0.01	0.01	0.01	0.01	0.05	0.09	0.13	0.17	0.20	0.23	0.26	0.29	0.30
0.04	0.00	0.00	0.00	0.00	0.01	0.01	0.01	0.01	0.01	0.05	0.09	0.13	0.16	0.19	0.22	0.25	0.28	0.28
0.04	0.00	0.00	0.00	0.00	0.01	0.01	0.01	0.01	0.01	0.04	0.08	0.12	0.15	0.19	0.21	0.24	0.27	0.27
0.04	0.00	0.00	0.00	0.00	0.01	0.01	0.01	0.01	0.01	0.04	0.08	0.11	0.15	0.18	0.21	0.23	0.26	0.26
0.03	0.00	0.00	0.00	0.00	0.00	0.01	0.01	0.01	0.01	0.04	0.08	0.11	0.14	0.17	0.20	0.22	0.25	0.26
0.03	0.00	0.00	0.00	0.00	0.00	0.01	0.01	0.01	0.01	0.04	0.07	0.11	0.14	0.16	0.19	0.22	0.24	0.25
0.03	0.00	0.00	0.00	0.00	0.00	0.01	0.01	0.01	0.01	0.04	0.07	0.10	0.13	0.16	0.18	0.21	0.23	0.24
0.03	0.00	0.00	0.00	0.00	0.00	0.00	0.01	0.01	0.01	0.03	0.07	0.10	0.13	0.15	0.18	0.20	0.22	0.23
0.03	0.00	0.00	0.00	0.00	0.00	0.00	0.01	0.01	0.01	0.03	0.06	0.09	0.12	0.15	0.17	0.19	0.22	0.22
0.03	0.00	0.00	0.00	0.00	0.00	0.00	0.01	0.01	0.01	0.03	0.06	0.09	0.12	0.14	0.16	0.19	0.21	0.21
0.03	0.00	0.00	0.00	0.00	0.00	0.00	0.01	0.01	0.01	0.03	0.06	0.09	0.11	0.14	0.16	0.18	0.20	0.21
0.03	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.01	0.01	0.03	0.06	0.08	0.11	0.13	0.15	0.17	0.19	0.20
0.03	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.01	0.01	0.03	0.05	0.08	0.10	0.13	0.15	0.17	0.19	0.19
0.03	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.01	0.03	0.05	0.08	0.10	0.12	0.14	0.16	0.18	0.19
0.03	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.01	0.03	0.05	0.07	0.10	0.12	0.14	0.16	0.18	0.18
0.03	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.01	0.03	0.05	0.07	0.09	0.11	0.13	0.15	0.17	0.18
0.03	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.02	0.05	0.07	0.09	0.11	0.13	0.15	0.16	0.17
0.03	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.02	0.05	0.07	0.09	0.11	0.12	0.14	0.16	0.17
0.03	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.02	0.04	0.06	0.08	0.10	0.12	0.14	0.15	0.16
0.03	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.02	0.04	0.06	0.08	0.10	0.12	0.13	0.15	0.16
0.02	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.02	0.04	0.06	0.08	0.10	0.11	0.13	0.15	0.15
0.02	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.02	0.04	0.06	0.08	0.09	0.11	0.13	0.14	0.15
0.02	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.02	0.04	0.06	0.07	0.09	0.11	0.12	0.14	0.14
0.02	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.02	0.04	0.05	0.07	0.09	0.10	0.12	0.13	0.14
0.02	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.02	0.04	0.05	0.07	0.09	0.10	0.12	0.13	0.13
0.02	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.02	0.03	0.05	0.07	0.08	0.10	0.11	0.13	0.13
 ]);

%% Main Drive Cooling
n1=380/0.78
n2=1100/0.7
p=500/0.8
Venti_n2 = 273+40;
MainDrive.m = 40;            % [kg] Mass
MainDrive.R  = 25;            % [W/K/m^2] Heat transfere resistance of surface
MainDrive.A  = 0.7;           % [m^2] surface area
MainDriveCooling.epsilon = 0.8;
MainDriveCooling.Tmin = 30+273;
MainDriveCooling.Tmax = 40+273;
MainDriveCooling.Air.T_int = [10 20 30 40 50 60 70 80 90]+273;
MainDriveCooling.Air.T_ext = [10 20 30 40]+273;
MainDriveCooling.Air.P  = [     150, 0, 0,  0; ...
                                1500, 150, 0, 0; ...
                                3000, 1500, 150, 0; ...
                                4500, 3000, 1500, 150; ...
                                6000, 4500, 3000, 1500; ...
                                7500, 6000, 4500, 3000; ...
                                9000, 7500, 6000, 4500; ...
                                10500, 9000, 7500, 6000; ...
                                12000, 10500, 9000, 7500  ];
                            
  MainDriveCooling.Air.P_n2  = [200, 0, 0,  0; ...
                                2000, 200, 0, 0; ...
                                3500, 2000, 200, 0; ...
                                5000, 3500, 2000, 200; ...
                                6500, 5000, 3500, 2000; ...
                                8000, 6500, 5000, 3500; ...
                                9500, 8000, 6500, 5000; ...
                                11000, 9500, 8000, 6500; ...
                                12500, 11000, 9500, 8000  ];               

%% CNC
% *Cabinet*
CNC.Cabinet.m  = 200;     % [kg] Mass inside the cabinet
CNC.Cabinet.A  = 2+2.5+5;     % [m^2] surface area


CNC.Cooling.Tmin = 40+273;
CNC.Cooling.Tmax = 45+273;
CNC.Cooling.T_int = [20 30 40 50]+273;
CNC.Cooling.T_ext = [20 30 40 50]+273;
CNC.Cooling.Qdot  = [1650, 1283, 912,  550; ...
                     2250, 1883, 1517, 1150; ...
                     2850, 2483, 2117, 1750; ...
                     3450, 3083, 2717, 2350];
CNC.Cooling.epsilon = 2;
% *SimuDrive*
CNC.SimoDrive.OpPointsP   = [0 89e3];
CNC.SimoDrive.OpPointsEta = [.4 .92];
CNC.SimoDrive.PStandby    = 500;
